### âŒ¨ï¸ ë„ì»¤ ëª…ë ¹ì–´ ëª¨ìŒ (ì°¾ê¸°, ctrl + f)

## ğŸ“Œ ì´ë¯¸ì§€ 
### ì´ë¯¸ì§€ ê²€ìƒ‰í•˜ê¸° (nginx)
```
$ docker search nginx
```

### ì´ë¯¸ì§€ ë‚´ë ¤ë°›ê¸°, ë‹¤ìš´ë¡œë“œ (nginx)
```
$ docker pull nginx
```
ì•„ë¬´ëŸ° ì¡°ê±´ì„ ì£¼ì§€ ì•Šê³  ì´ë¦„ë§Œìœ¼ë¡œ `pull`ì„ ìˆ˜í–‰í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ `latest` íƒœê·¸ê°€ ì ìš©ëœë‹¤.

#### ì•ˆì •í™” ë²„ì „(stable)ì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´...
```
$ docker pull nginx:stable
```

### ì´ë¯¸ì§€ ì¡°íšŒí•˜ê¸° (ì „ì²´)
```
$ docker image ls
```

### ì´ë¯¸ì§€ ì¡°íšŒí•˜ê¸° (nginx, íŠ¹ì •)
```
$ docker images nginx
```

### ì´ë¯¸ì§€ ìƒì„± ê³¼ì • ë‚´ì—­ ì¡°íšŒí•˜ê¸° (nginx)
```
$ docker history nginx:latest
```

## ğŸ“Œ ì»¨ë„¤ì´ë„ˆ
### ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°
```
$ docker run -d -p 8080:80 --name nginx-exposed -v /root/html:/usr/share/nginx/html --restart always nginx
```
- -d: ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ êµ¬ë™í•œë‹¤.
- -p: í¬íŠ¸ ì„¤ì •
- --name: ì»¨í…Œì´ë„ˆ ì´ë¦„ì„ ì§€ì •í•œë‹¤.
- -v: [í˜¸ìŠ¤íŠ¸ ë””ë ‰í† ë¦¬]:[ì»¨í…Œì´ë„ˆ ë””ë ‰í† ë¦¬]ë¥¼ ì—°ê²°í•œë‹¤.(ë§ˆìš´íŠ¸, ë³¼ë¥¨)
- --restart always: ì»¨í…Œì´ë„ˆì˜ ì¬ì‹œì‘ê³¼ ê´€ë ¨ëœ ì •ì±…ì„ ì˜ë¯¸í•˜ëŠ” ì˜µì…˜ìœ¼ë¡œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê±°ë‚˜ ì¤‘ì§€ë˜ëŠ” ê²½ìš° ì¦‰ì‹œ ì¬ì‹œì‘í•˜ê±°ë‚˜, ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
  - ê¸°ë³¸ê°’ì€ `no`

### ì»¨í…Œì´ë„ˆ ì¤‘ì§€í•˜ê¸°
```
$ docker stop nginx-exposed
```

### nginx ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»¨í…Œì´ë„ˆ ID ì¡°íšŒ (-q ì˜µì…˜)
```
$ docker ps -q -f ancestor=nginx
```

### nginx ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»¨í…Œì´ë„ˆ ì¤‘ì§€
```
$ docker stop $(docker ps -q -f ancestor=nginx)
```

### ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
```
$ docker ps
```

### ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í™•ì¸í•˜ê¸°
```
$ docker exec 1b4a24ab3ec8 ls /usr/share/nginx/html
```
ì»¨í…Œì´ë„ˆ ID(1b4a24ab3ec8), ë˜ëŠ” ì´ë¦„ë„ ê°€ëŠ¥)ì˜ `/usr/share/nginx/html` ê²½ë¡œì—ì„œ `ls` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œë‹¤.

### ì»¨í…Œì´ë„ˆ ì‚­ì œí•˜ê¸°
```
$ docker rm ì»¨í…Œì´ë„ˆID
```

### ë³¼ë¥¨ ìƒì„±í•˜ê¸°
```
$ docker volume create nginx-volume
```

### ë³¼ë¥¨ ì „ì²´ ì¡°íšŒí•˜ê¸°
```
$ docker volume ls
```

### ë³¼ë¥¨ ìƒì„¸ ì¡°íšŒí•˜ê¸°
```
$ docker volume inspect nginx-volume
```
```
[
    {
        "CreatedAt": "2023-11-14T22:35:22Z",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/nginx-volume/_data",
        "Name": "nginx-volume",
        "Options": {},
        "Scope": "local"
    }
]
```
`nginx-volume` ì´ë¦„ìœ¼ë¡œ ìƒì„±í•œ ë³¼ë¥¨ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ë°”ì¸ë“œ ë§ˆìš´íŠ¸ ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ë³¼ë¥¨ì€ ë¹ˆ ë””ë ‰í† ë¦¬ë¥¼ ë®ì–´ ì“°ì§€ ì•Šê³  ì»¨í…Œì´ë„ˆ ë””ë ‰í† ë¦¬ íŒŒì¼ì„ ë³´ì¡´í•œë‹¤.

## ğŸ“Œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë¹Œë“œí•˜ê¸° 
ì†ŒìŠ¤ ì½”ë“œê°€ ìë°”ë¡œ ì‘ì„±ë˜ì–´ ìˆëŠ” êµ¬ì„±ì—ì„œ ì‘ì„±í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

### íŒ¨í‚¤ì§€ êµ¬ì¡°
- DockerFile
- mvnw
- pom.xml
- src

ì•„ë˜ ê³¼ì •ì€ DockerFileì— ì‘ì„±ë˜ì–´ìˆëŠ” ë‚´ìš©ìœ¼ë¡œ Docker build ë˜ë©°, `chmod 700 mvnw`, `./mvnw clean package` ì„  ì‘ì—…ìœ¼ë¡œ target í´ë”ì— jar íŒŒì¼ì´
ì¡´ì¬í•˜ëŠ” ìƒíƒœì—ì„œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
```
$ docker build -t basic-img .
```
-t(tag)ëŠ” ë§Œë“¤ì–´ì§ˆ ì´ë¯¸ì§€ë¥¼ ì˜ë¯¸í•˜ê³ , .(dot, ì )ì€ ì´ë¯¸ì§€ì— ì›í•˜ëŠ” ë‚´ìš©ì„ ì¶”ê°€í•˜ê±°ë‚˜ ë³€ê²½í•˜ëŠ”ë° í•„ìš”í•˜ë‚˜ ì‘ì—…ê³µê°„ì„ í˜„ì¬ ë””ë ‰í† ë¦¬ë¡œ ì§€ì •í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

### ì ê¹, ì—¬ê¸°ì„œ DockerFile ì´ë€?
ë¹Œë“œìš© DSL(Domain-Specific Language, ë„ë©”ì¸ íŠ¹í™” ì–¸ì–´)ë¡œ ì‘ì„±ëœ íŒŒì¼ì´ë‹¤.

#### DockerFile ì‘ì„± ì˜ˆ
```
FROM openjdk:8 -- 1
LABEL description="Echo IP Java Application" -- 2
EXPOSE 60431 -- 3
COPY ./target/app-in-host.jar /opt/app-in-image.jar -- 4
WORKDIR /opt -- 5
ENTRYPOINT [ "java", "-jar", "app-in-image.jar" ] -- 6
```
#### 1: openjdk:8 ì´ë¯¸ì§€ ë‚´ë¶€ì—ì„œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•œë‹¤. ì—¬ê¸°ì„œ openjdkë¥¼ ê¸°ì´ˆ ì´ë¯¸ì§€ë¡œ ì‚¬ìš©í•œë‹¤.
#### 2: ì´ë¯¸ì§€ì— ë¶€ê°€ì ì¸ ì„¤ëª…ì„ ìœ„í•œ ë ˆì´ë¸”ì„ ì¶”ê°€í•  ë•Œ ì‚¬ìš©ëœë‹¤.
#### 3: ì»¨í…Œì´ë„ˆë¡œ êµ¬ë™í•  ë•Œ ì–´ë–¤ í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œë ¤ì¤€ë‹¤. â—ï¸ ì£¼ì˜, ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•  ë–„ ìë™ìœ¼ë¡œ í•´ë‹¹ í¬íŠ¸ë¥¼ í˜¸ìŠ¤íŠ¸ í¬íŠ¸ì™€ ì—°ê²°í•˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¨ì§€ ì •ë³´ë¥¼ ì œê³µí•  ë¿ì´ë‹¤.
#### 4: í˜¸ìŠ¤íŠ¸ì—ì„œ ìƒˆë¡œ ìƒì„±í•˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œ í•„ìš”í•œ íŒŒì¼ì„ ë³µì‚¬í•œë‹¤. app-in-host.jar íŒŒì¼ì„ ì´ë¯¸ì§€ì˜ /opt/app-in-image.jar ë¡œ ë³µì‚¬í•œë‹¤.
#### 5: ì´ë¯¸ì§€ì˜ í˜„ì¬ ì‘ì—… ìœ„ì¹˜ë¥¼ optë¡œ ë³€ê²½í•œë‹¤.
#### 6: ëŒ€ê´„í˜¸ ì•ˆì— ë“  ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤. ì½¤ë§ˆë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ ì¤‘ ì²« ë²ˆì§¸ ë¬¸ìì—´ì„ ì‹¤í–‰í•  ëª…ë ¹ì–´ê³ , ë‘ ë²ˆì§¸ ë¬¸ìì—´ë¶€í„° ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ë•Œ ì¶”ê°€í•˜ëŠ” ì˜µì…˜ì´ë‹¤. ì—¬ê¸°ì„œëŠ” java -jar app-in-image.jar ê°€ ì‹¤í–‰ëœë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

### íƒœê·¸ ì‚¬ìš©í•˜ê¸°
```
$ docker build -t basic-img:1.0 -t basic-img:2.0 .
```
íƒœê·¸ ì˜µì…˜(-t)ì„ ì¶”ê°€í•˜ì—¬ 1.0ê³¼ 2.0 íƒœê·¸ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤. ë¹ ë¥¸ ì†ë„ë¡œ ìƒì„±ì´ ë˜ëŠ”ë° ê·¸ ì´ìœ ëŠ” ì´ë¯¸ ìƒì„±ë˜ì–´ìˆëŠ” basic-img ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œí•˜ì—¬ ìºì‹œí•˜ê¸° ë•Œë¬¸ì´ë‹¤.



## ğŸ“Œ ì¿ ë²„ë„¤í‹°ìŠ¤
### í˜„ì¬ ì‚¬ìš©í•˜ëŠ” ë„ì»¤ ë²„ì „ í™•ì¸
```
$ kubectl get nodes -o wide
```
`CONTAINER-RUNTIME` ë¶€ë¶„ì„ í™•ì¸í•œë‹¤.

### ë””í”Œë¡œì´ë¨¼íŠ¸ ìƒì„±
```
$ kubectl create deployment failure1 --image=basic-img
```
- --image: ëŒ€ìƒ ì´ë¯¸ì§€ ì§€ì •
- failure1: failure1 ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì§€ì •
ErrorImagePullê³¼ ImagePullBackOff ê°€ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ” ì´ë¯¸ì§€ê°€ í˜¸ìŠ¤íŠ¸ì— ì¡´ì¬í•¨ì—ë„ ê¸°ë³¸ ì„¤ì •ì— ë”°ë¼ ì™¸ë¶€(ë„ì»¤ í—ˆë¸Œ)ì—ì„œ ë‚´ë ¤ ë°›ìœ¼ë ¤ê³  ì‹œë„í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

### ë””í”Œë¡œì´ë¨¼íŠ¸ ìƒì„± (ë‚´ë¶€ ì´ë¯¸ì§€ ì´ìš©)
```
$ kubectl create deployment failure2 --dry-run=client -o yaml --image=basic-img > failure2.yaml
```

### ìˆ˜ì •í•œ yaml íŒŒì¼ì„ ë””í”Œë¡œì´ë¨¼íŠ¸ì— ì ìš©
```
$ kubectl apply -f failure2.yaml
```

### íŒŒë“œì˜ ìƒíƒœ ë° ë³€í™” í™•ì¸í•˜ê¸°
```
kubectl get pods -w
```












